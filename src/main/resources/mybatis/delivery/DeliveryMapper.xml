<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bootdo.delivery.dao.DeliveryDao">
	<select id="getDeliveryById" resultType="com.bootdo.delivery.vo.DeliveryVo" parameterType="String">
		select
		--主表
		a.contract_id contractId, --合同号
		a.division_id divisionId, --事业部
		a.theme theme, --主题
		a.flow_no flow, --流水号
		a.status status --状态
		DATE_FORMAT(a.create_time, '%Y-%m-%d %H-%i-%s') createTime --创建时间
		--b表
		b.name name, --name
		b.value userId, --id
		--c表
		c.name deliveryLevel,
		c.value deliveryLeveryId,
		--d表
		d.name deliveryType,
		d.value deliveryTypeId,

	 	from
		t_business_delivery_application a
		left join (
		select
		`name`,
		`value`
		from
		sys_user
		<where>
			and status = 1
		</where>
		) b
		on a.CREATE_USER_ID = b.value
		left join (
		SELECT
		`value`,
		`name`
		FROM
		sys_dict
		<where>
		type = 'deliveryLevel'
		</where>
		) c
		on a.DELIVERY_LEVEL = c.value
		left join (
		SELECT
		`value`,
		`name`
		FROM
		sys_dict
		WHERE
		type = 'deliveryType'
		) d on a.delivery_type = d.value
		<where>
			and id = #{id}
		</where>
	</select>
</mapper>